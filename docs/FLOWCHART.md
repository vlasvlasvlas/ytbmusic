# YTBMusic - Resumen Visual del Flujo

## ğŸ“Š Diagrama

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   INICIO: ./run.sh                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Activar venv   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Test MPV funciona? â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                     â”‚        â”‚
                 SÃ  â”‚        â”‚ NO
                     â”‚        â”‚
                     â–¼        â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  main.py     â”‚  â”‚ old_play.py  â”‚
          â”‚ (MPV nuevo)  â”‚  â”‚ (VLC legacy) â”‚
          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MENÃš SELECCIÃ“N PLAYLIST                   â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚    SELECT PLAYLIST                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                            â”‚
â”‚    > [lofi]            â† cursor aquÃ­ (â†‘/â†“ para mover)     â”‚
â”‚      rock                                                  â”‚
â”‚      vladitest                                             â”‚
â”‚      workout                                               â”‚
â”‚                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  [â†‘/â†“] Navigate  [Enter] Select  [Q] Quit                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼ (presionÃ¡ Enter)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CARGA PLAYLIST + AUTO-PLAY                    â”‚
â”‚  1. Lee playlists/vladitest.json                           â”‚
â”‚  2. Carga tracks en memoria                                â”‚
â”‚  3. Inicia reproducciÃ³n track #1 AUTOMÃTICAMENTE          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PANTALLA PRINCIPAL (SKIN)                     â”‚
â”‚                                                            â”‚
â”‚         ___________________________________________        â”‚
â”‚        |  _______________________________________  |       â”‚
â”‚        | / .-----------------------------------. \ |       â”‚
â”‚        | | | /\ :  Mi vida en rosa     90 min| | |       â”‚
â”‚        | | |/--\:....Los Romeos....... NR [ ]| | |       â”‚
â”‚        | |      //-\   |         |   //-\      | |       â”‚
â”‚        | |     ||( )||  |_________|  ||( )||     | |  â† ANIMA!
â”‚        | |      \-//   :....:....:   \-//      | |       â”‚
â”‚        | |  03:45 / 06:07        ğŸµ  1/2        | |       â”‚
â”‚        | |  [========>          ]                | |       â”‚
â”‚        | |   [ â® ]  [ â¸ ]  [ â­ ]              | |       â”‚
â”‚        !______/_____________________________\______!       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ â–¶ Mi vida en rosa (streaming)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
          REPRODUCIENDO â™«

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚             â”‚              â”‚
    â–¼             â–¼             â–¼              â–¼
 STREAMING    CACHING      ANIMACIÃ“N       LOGGER
    â”‚             â”‚             â”‚              â”‚
    â–¼             â–¼             â–¼              â–¼
[YouTube]   [Descarga]   [2 FPS loop]   [logs/*.log]
 â†’ mpv       â†’ cache/     â†’ Reels rotan  â†’ Historial
             â†’ .m4a       â†’ Si playing   â†’ Stats
```

---

## ğŸ® Controles y Efectos

```
DURANTE REPRODUCCIÃ“N:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ACCIÃ“N               â”‚  RESULTADO                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Space                 â”‚ Play/Pause                       â”‚
â”‚                       â”‚ â†’ Si pause: tiempo PARPADEA      â”‚
â”‚                       â”‚ â†’ Si play: animaciÃ³n ACTIVA      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ N (Next)              â”‚ PrÃ³ximo track                    â”‚
â”‚                       â”‚ â†’ BotÃ³n NEXT resalta 200ms       â”‚
â”‚                       â”‚ â†’ Auto-stream nuevo track        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ P (Previous)          â”‚ Track anterior                   â”‚
â”‚                       â”‚ â†’ BotÃ³n PREV resalta 200ms       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + / -                 â”‚ Volumen â†‘/â†“                      â”‚
â”‚                       â”‚ â†’ Botones VOL resaltan           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ S (Skin)              â”‚ Cambia skin                      â”‚
â”‚                       â”‚ â†’ cassette â†’ cassette_animated   â”‚
â”‚                       â”‚ â†’ boombox â†’ radio â†’ ...          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Z (Shuffle)           â”‚ Toggle shuffle ON/OFF            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ R (Repeat)            â”‚ Cycle: NONE â†’ TRACK â†’ PLAYLIST   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Q (Quit)              â”‚ Sale + guarda estado             â”‚
â”‚                       â”‚ â†’ BotÃ³n QUIT resalta             â”‚
â”‚                       â”‚ â†’ Logs actualizados              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¬ AnimaciÃ³n Timeline

```
SKIN ESTÃTICO (cassette.txt):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Frame Ãºnico siempre igual
No cambia durante playback


SKIN ANIMADO (cassette_animated.txt):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
t=0.0s   FRAME_1: ||( )||  â† Cintas posiciÃ³n 1
t=0.5s   FRAME_2: ||(_)||  â† Cintas posiciÃ³n 2
t=1.0s   FRAME_1: ||( )||  â† Vuelve a frame 1
t=1.5s   FRAME_2: ||(_)||
...continÃºa ciclando a 2 FPS

PAUSED: AnimaciÃ³n DETENIDA en frame actual
```

---

## ğŸ’¾ Archivos Generados Durante Uso

```
ytbmusic/
â”œâ”€â”€ cache/
â”‚   â”œâ”€â”€ wydOyGNFf4I.m4a      â† Track descargado
â”‚   â””â”€â”€ tXggyHNwO9A.m4a      â† Track descargado
â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ playback.log         â† Historial completo
â”‚   â”œâ”€â”€ errors.log           â† Errores si hay
â”‚   â””â”€â”€ statistics.json      â† Stats de uso
â””â”€â”€ config/
    â””â”€â”€ state.json           â† Estado persistente
        {
          "last_playlist": "vladitest",
          "last_skin": "cassette_animated",
          "last_volume": 75,
          "session_count": 3,
          ...
        }
```

---

## ğŸ”„ Ciclo de Vida de un Track

```
1. Usuario presiona Enter en playlist
   â†“
2. _play_track(track) se ejecuta
   â†“
3. downloader.is_cached(url)
   â”‚
   â”œâ”€ SÃ en cache â†’ mpv.play(cache/file.m4a)
   â”‚                â””â”€ Status: "â–¶ TÃ­tulo (cached)"
   â”‚
   â””â”€ NO en cache â†’ downloader.get_stream_url(url)
                     â””â”€ mpv.play(stream_url)
                     â””â”€ Status: "â–¶ TÃ­tulo (streaming)"
                     â””â”€ Background: download() â†’ cache/
   â†“
4. Logger.log_track_start()
   â†“
5. Config.save_playback_state()
   â†“
6. Render loop comienza
   â”‚
   â”œâ”€ Cada 100ms: render()
   â”œâ”€ Cada 500ms (FPS=2): cambio frame si playing
   â””â”€ Cada 500ms si paused: toggle blink
   â†“
7. Track termina â†’ on_end_callback()
   â†“
8. Auto next() si repeat != NONE
   â†“
9. Vuelve a step 2 con nuevo track
```

---

**Ahora entendÃ©s el flujo completo! ğŸ‰**
